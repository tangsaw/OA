select `td_oa`.`user`.`USER_ID` AS `USER_ID`,`td_oa`.`user`.`USER_NAME` AS `USER_NAME`,`td_oa`.`user`.`BYNAME` AS `BYNAME`,`td_oa`.`user`.`DEPT_ID` AS `DEPT_ID`,`td_oa`.`department`.`DEPT_NAME` AS `DEPT_NAME`,(select `td_oa`.`diary`.`DIA_DATE` from `td_oa`.`diary` where ((date_format(`td_oa`.`diary`.`DIA_DATE`,'%Y-%m') = date_format(now(),'%Y-%m')) and (`td_oa`.`diary`.`SUBJECT` like '%ÔÂ%')) order by `td_oa`.`diary`.`DIA_DATE` desc limit 1) AS `t_date`,`tj_oa`.`ud_userdiary`.`User_Dept` AS `User_Dept`,`tj_oa`.`ud_userdiary`.`isSat` AS `isSat`,`tj_oa`.`ud_userdiary`.`isSun` AS `isSun`,`tj_oa`.`ud_userdiary`.`isClass` AS `isClass`,`tj_oa`.`ud_userdiary`.`typeName` AS `typeName` from ((`tj_oa`.`ud_userdiary` left join `td_oa`.`user` on((`td_oa`.`user`.`BYNAME` = `tj_oa`.`ud_userdiary`.`BYNAME`))) left join `td_oa`.`department` on((`td_oa`.`department`.`DEPT_ID` = `td_oa`.`user`.`DEPT_ID`))) where (`tj_oa`.`ud_userdiary`.`typeName` = 1)